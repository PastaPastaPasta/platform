# TODO: We shouldn't go with tokio_unstable to production

[target.aarch64-unknown-linux-musl]
rustflags = ["-C", "target-feature=-crt-static", "--cfg", "tokio_unstable"]
linker = "aarch64-linux-musl-gcc"

[target.x86_64-unknown-linux-musl]
rustflags = ["-C", "target-feature=-crt-static", "--cfg", "tokio_unstable"]
linker = "x86_64-linux-musl-gcc"

[target.aarch64-unknown-linux-gnu]
linker = "aarch64-linux-gnu-gcc"

[target.x86_64-unknown-linux-gnu]
linker = "x86_64-linux-gnu-gcc"

[target.aarch64-pc-windows-gnu]
linker = "aarch64-w64-mingw32-gcc"
rustflags = ["-C", "target-feature=-crt-static", "--cfg", "tokio_unstable", "-C", "link-arg=-Wl,--no-insert-timestamp"]

[target.x86_64-pc-windows-gnu]
linker = "x86_64-w64-mingw32-gcc"
rustflags = ["-C", "target-feature=-crt-static", "--cfg", "tokio_unstable", "-C", "link-arg=-Wl,--no-insert-timestamp"]

[profile.release]
opt-level = 3
debug = false
debug-assertions = false
overflow-checks = false
lto = true
panic = 'abort'
codegen-units = 1
incremental = false

[build]
rustflags = [
    "--cfg", "tokio_unstable",
    "-C", "relocation-model=pic",
    "-C", "strip=debuginfo"
]
